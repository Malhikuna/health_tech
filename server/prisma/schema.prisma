// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Tabel User
model User {
  id            String          @id @default(uuid()) @db.Char(36)
  email         String          @unique @db.VarChar(100)
  password      String          @db.VarChar(100)
  first_name    String          @db.VarChar(100)
  last_name     String?         @db.VarChar(100)
  profile_data  Json?
  created_at    DateTime        @default(dbgenerated("(CURRENT_TIMESTAMP)")) @db.Timestamp()
  User_Activity User_Activity[]

  @@map("users")
}

// Tabel Program
model Program {
  id              Int             @unique @default(autoincrement())
  name            String          @db.VarChar(255)
  description     String          @db.Text
  cover_image_url String          @db.VarChar(255)
  duration_days   Int
  Daily_Plan      Daily_Plan[]
  User_Activity   User_Activity[]

  @@map("programs")
}

// Tabel Resep
model Recipe {
  id                   Int          @unique @default(autoincrement())
  name                 String       @db.VarChar(255)
  description          String       @db.Text
  intructions          String       @db.Text
  colories             Int
  image_url            String       @db.VarChar(255)
  cooking_time_minutes Int
  breakfastPlans       Daily_Plan[] @relation("BreakfastRecipe")
  lunchPlans           Daily_Plan[] @relation("LunchRecipe")
  dinnerPlans          Daily_Plan[] @relation("DinnerRecipe")

  @@map("recipes")
}

// Tabel Perencanaan Harian
model Daily_Plan {
  id                  Int     @unique @default(autoincrement())
  program_id          Int
  day_number          Int
  breakfast_recipe_id Int
  lunch_recipe_id     Int
  dinner_recipe_id    Int
  program             Program @relation(fields: [program_id], references: [id])
  breakfast_recipe    Recipe  @relation("BreakfastRecipe", fields: [breakfast_recipe_id], references: [id])
  lunch_recipe        Recipe  @relation("LunchRecipe", fields: [lunch_recipe_id], references: [id])
  dinner_recipe       Recipe  @relation("DinnerRecipe", fields: [dinner_recipe_id], references: [id])

  @@map("daily_plans")
}

// Tabel Aktivitas Pengguna
model User_Activity {
  id                  Int      @unique @default(autoincrement())
  user_id             String
  program_id          Int
  day_number          Int
  activity_date       DateTime @db.Date
  breakfast_completed Int      @db.TinyInt
  lunch_completed     Int      @db.TinyInt
  dinner_completed    Int      @db.TinyInt
  user                User     @relation(fields: [user_id], references: [id])
  program             Program  @relation(fields: [program_id], references: [id])

  @@map("user_activities")
}
